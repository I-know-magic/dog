<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<dogrules:ruleList xsi:schemaLocation="http://elite.polito.it/domotics/dog/rules/rule_definition rule_definition.xsd " xmlns:dogrules="http://elite.polito.it/domotics/dog/rules/rule_definition" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <dogrules:rule name="smartinfo1">
        <dogrules:if>
            <dogrules:event>
                <dogrules:notification name="newActivePowerValue" class="SinglePhaseActivePowerMeasurementNotification" fromDevice="SmartInfoEmulator"/>
            </dogrules:event>
            <dogrules:when>
                <dogrules:state class="SinglePhaseActivePowerMeasurementState" ofDevice="SmartInfoEmulator" value="27.0" evaluator="&gt;"/>
            </dogrules:when>
        </dogrules:if>
        <dogrules:then>
            <dogrules:action>
                <dogrules:command name="off" class="OnOffFunctionality" toDevice="MainsPowerOutlet_2"/>
            </dogrules:action>
        </dogrules:then>
    </dogrules:rule>
    <dogrules:rule name="buttonToPlug">
        <dogrules:if>
            <dogrules:event>
                <dogrules:notification name="on" class="OnNotification" fromDevice="Switch_allPlugsLiving"/>
            </dogrules:event>
            <dogrules:when>
                <dogrules:state name="off" class="OnOffState" ofDevice="MainsPowerOutlet_p23_living"/>
            </dogrules:when>
        </dogrules:if>
        <dogrules:then>
            <dogrules:action>
                <dogrules:command name="on" class="OnOffFunctionality" toDevice="MainsPowerOutlet_p23_living"/>
            </dogrules:action>
            <dogrules:action>
                <dogrules:command name="off" class="OnOffFunctionality" toDevice="MainsPowerOutlet_p23_living"/>
                <dogrules:instant time="18:05:30"/>
            </dogrules:action>
        </dogrules:then>
    </dogrules:rule>
    <dogrules:rule name="smartinfo2">
        <dogrules:if>
            <dogrules:event>
                <dogrules:notification name="newActivePowerValue" class="SinglePhaseActivePowerMeasurementNotification" fromDevice="SmartInfoEmulator"/>
            </dogrules:event>
            <dogrules:when>
                <dogrules:state class="SinglePhaseActivePowerMeasurementState" ofDevice="SmartInfoEmulator" value="10.0" evaluator="&lt;"/>
            </dogrules:when>
        </dogrules:if>
        <dogrules:then>
            <dogrules:action>
                <dogrules:command name="on" class="OnOffFunctionality" toDevice="MainsPowerOutlet_2"/>
            </dogrules:action>
        </dogrules:then>
    </dogrules:rule>
    <dogrules:rule name="rule1">
        <dogrules:if>
            <dogrules:event>
                <dogrules:notification name="stateChanged" class="StateChangeNotification" fromDevice="Shutter1">
                    <dogrules:param name="newState" value="lowering" type="ShutterState"/>
                </dogrules:notification>
            </dogrules:event>
            <dogrules:when>
                <dogrules:state name="off" class="OnOffState" ofDevice="Lamp1"/>
            </dogrules:when>
            <dogrules:when>
                <dogrules:state class="LightIntensityState" ofDevice="Lamp2" value="50.0" evaluator="&lt;"/>
            </dogrules:when>
        </dogrules:if>
        <dogrules:or-if>
            <dogrules:event>
                <dogrules:notification name="stateChanged" class="StateChangeNotification" fromDevice="Shutter2">
                    <dogrules:param name="newState" value="lowering"/>
                </dogrules:notification>
            </dogrules:event>
            <dogrules:when>
                <dogrules:state name="off" class="OnOffState" ofDevice="Lamp1"/>
            </dogrules:when>
            <dogrules:when>
                <dogrules:state class="LightIntensityState" ofDevice="Lamp2" value="50.0" evaluator="&lt;"/>
            </dogrules:when>
        </dogrules:or-if>
        <dogrules:then>
            <dogrules:action>
                <dogrules:command name="on" class="OnOffFunctionality" toDevice="Lamp1"/>
                <dogrules:command name="set" class="LightRegulationFunctionality" toDevice="Lamp3">
                    <dogrules:param name="value" value="50"/>
                </dogrules:command>
            </dogrules:action>
        </dogrules:then>
    </dogrules:rule>
    <dogrules:rule name="timedOnOven">
        <dogrules:if>
            <dogrules:event>
                <dogrules:notification name="pressed" class="PressedNotification" fromDevice="Button1"/>
            </dogrules:event>
            <dogrules:when>
                <dogrules:state name="off" class="OnOffState" ofDevice="Plug2"/>
            </dogrules:when>
        </dogrules:if>
        <dogrules:or-if>
            <dogrules:event>
                <dogrules:notification name="c31b6dbe-b431-4c86-b4f7-6595a98319f4" class="TimedTriggerNotification" fromDevice="DogScheduler">
                    <dogrules:param name="triggerId" value="c31b6dbe-b431-4c86-b4f7-6595a98319f4"/>
                </dogrules:notification>
            </dogrules:event>
        </dogrules:or-if>
        <dogrules:or-if>
            <dogrules:event>
                <dogrules:notification name="ace9dc83-998a-47c5-84b2-38053f7b12f7" class="TimedTriggerNotification" fromDevice="DogScheduler">
                    <dogrules:param name="triggerId" value="ace9dc83-998a-47c5-84b2-38053f7b12f7"/>
                </dogrules:notification>
            </dogrules:event>
        </dogrules:or-if>
        <dogrules:or-if>
            <dogrules:event>
                <dogrules:notification name="8b137f89-27c1-4170-8aa3-0bfb4e12ad7c" class="TimedTriggerNotification" fromDevice="DogScheduler">
                    <dogrules:param name="triggerId" value="8b137f89-27c1-4170-8aa3-0bfb4e12ad7c"/>
                </dogrules:notification>
            </dogrules:event>
        </dogrules:or-if>
        <dogrules:then>
            <dogrules:action>
                <dogrules:command name="on" class="OnOffFunctionality" toDevice="kitchenOven"/>
                <dogrules:interval duration="PT45M"/>
            </dogrules:action>
            <dogrules:action>
                <dogrules:command name="set" class="TemperatureRegulationFunctionality" toDevice="kitchenOven">
                    <dogrules:param name="value" value="230"/>
                </dogrules:command>
            </dogrules:action>
            <dogrules:action>
                <dogrules:command name="on" class="OnOffFunctionality" toDevice="SimpleLamp_lamp3_storage"/>
                <dogrules:instant time="20:00:00"/>
            </dogrules:action>
        </dogrules:then>
    </dogrules:rule>
</dogrules:ruleList>
